<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Docker Compose—简化复杂应用的利器  | Ivan&#39;s Blog | Thinking as a Geek</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="theme-color" content="#2196f3">
  
  
  <meta name="keywords" content="docker">
  <meta name="description" content="Compose是用于定义和运行复杂Docker应用的工具。你可以在一个文件中定义一个多容器的应用，然后使用一条命令来启动你的应用，然后所有相关的操作都会被自动完成。1. 安装Docker和Compose                    # 当前最新的Docker是1.6.2，Compose为1.2">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker Compose—简化复杂应用的利器 ">
<meta property="og:url" content="http://blog.yfgeek.com/2016/10/15/Docker-Compose—简化复杂应用的利器/index.html">
<meta property="og:site_name" content="Ivan's Blog">
<meta property="og:description" content="Compose是用于定义和运行复杂Docker应用的工具。你可以在一个文件中定义一个多容器的应用，然后使用一条命令来启动你的应用，然后所有相关的操作都会被自动完成。1. 安装Docker和Compose                    # 当前最新的Docker是1.6.2，Compose为1.2">
<meta property="og:updated_time" content="2016-10-15T18:11:28.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Docker Compose—简化复杂应用的利器 ">
<meta name="twitter:description" content="Compose是用于定义和运行复杂Docker应用的工具。你可以在一个文件中定义一个多容器的应用，然后使用一条命令来启动你的应用，然后所有相关的操作都会被自动完成。1. 安装Docker和Compose                    # 当前最新的Docker是1.6.2，Compose为1.2">
  
    <link rel="alternative" href="/atom.xml" title="Ivan&#39;s Blog" type="application/atom+xml">
  
  <meta name="summary" content="Thinking as a Geek">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="loading" class="active"></div>

  <nav id="menu" class="hide" >
   <div class="inner flex-row-vertical">
  <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
      <i class="icon icon-lg icon-close"></i>
  </a>
  <div class="brand-wrap">
    <div class="brand">
      <a href="/" class="avatar"><img src="/img/logo.jpg"></a>
      <hgroup class="introduce">
        <h5 class="nickname">Ivan</h5>
      </hgroup>
    </div>
  </div>
  <div class="scroll-wrap flex-col">
    <ul class="nav">
      
          <li class="waves-block waves-effect">
            <a href="/"  >
              <i class="icon icon-lg icon-home"></i>
              主页
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="/fav"  >
              <i class="icon icon-lg icon-archives"></i>
              收藏夹
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="/tags"  >
              <i class="icon icon-lg icon-tags"></i>
              分类
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="https://github.com/yfgeek" target="_blank" >
              <i class="icon icon-lg icon-github"></i>
              Github
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="http://www.weibo.com/yfsss" target="_blank" >
              <i class="icon icon-lg icon-weibo"></i>
              Weibo
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="/about" target="_blank" >
              <i class="icon icon-lg icon-link"></i>
              关于
            </a>
          </li>
      
    </ul>

    
  </div>
</div>

  </nav>
  <main id="main">
    <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Docker Compose—简化复杂应用的利器 </div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input " autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
    </div>
</header>
<header class="content-header">
  <div class="container">
    <h1 class="author">Docker Compose—简化复杂应用的利器 </h1>
    <h5 class="subtitle">
        
            <time datetime="2016-10-15T18:10:35.000Z" itemprop="datePublished" class="page-time">
  2016-10-15
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/docker/">docker</a></li></ul>

        
    </h5>
  </div>
</header>

    <div class="container body-wrap">
      <article id="post-Docker-Compose—简化复杂应用的利器" 
  class="article article-type-post" itemprop="blogPost">
    <div class="post-meta flex-row">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li></ul>

    </div>
    <div class="post-body">
        <aside class="post-widget" id="post-widget">

            

            
            <nav class="post-toc-wrap" id="post-toc">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-text">1. 安装Docker和Compose</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-text">2. 使用Compose</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-text">3. Yaml文件参考</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-text">4. docker-compose常用命令</span></a></li></ol>
            </nav>
            
        </aside>

        <div class="post-main">

            <div class="post-content" id="post-content" itemprop="postContent">
            <div class="entry-content"><br>                                                <p>Compose是用于定义和运行复杂Docker应用的工具。你可以在一个文件中定义一个多容器的应用，然后使用一条命令来启动你的应用，然后所有相关的操作都会被自动完成。<span id="more-1319"></span></p><br><h2>1. 安装Docker和Compose</h2><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c25730712728" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># 当前最新的Docker是1.6.2，Compose为1.2.0<br>curl -s <a href="https://get.docker.io/ubuntu/" target="_blank" rel="external">https://get.docker.io/ubuntu/</a> | sudo sh<br>sudo apt-get update<br>sudo apt-get install lxc-docker<br># 参考<a href="http://docs.docker.com/compose/install/#install-compose" target="_blank" rel="external">http://docs.docker.com/compose/install/#install-compose</a><br>curl -L <a href="https://github.com/docker/compose/releases/download/1.2.0/docker-compose-`uname" target="_blank" rel="external">https://github.com/docker/compose/releases/download/1.2.0/docker-compose-`uname</a> -s<code>-</code>uname -m<code>&amp;gt; /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
### 上面这个方法真的慢出翔，可以通过Python pip安装。
apt-get install python-pip python-dev
pip install -U docker-compose&lt;/textarea&gt;&lt;/div&gt;
            &lt;div class=&quot;crayon-main&quot; style=&quot;position: relative; z-index: 1; overflow: hidden;&quot;&gt;
                &lt;table class=&quot;crayon-table&quot;&gt;
                    &lt;tbody&gt;&lt;tr class=&quot;crayon-row&quot;&gt;
                &lt;td class=&quot;crayon-nums &quot; data-settings=&quot;show&quot;&gt;
                    &lt;div class=&quot;crayon-nums-content&quot; style=&quot;font-size: 12px !important; line-height: 15px !important;&quot;&gt;&lt;div class=&quot;crayon-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-1&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;crayon-num crayon-striped-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-2&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;crayon-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-3&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;crayon-num crayon-striped-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-4&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;crayon-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-5&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;crayon-num crayon-striped-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-6&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;crayon-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-7&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;crayon-num crayon-striped-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-8&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;crayon-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-9&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;crayon-num crayon-striped-num&quot; data-line=&quot;crayon-580270f9a8c25730712728-10&quot;&gt;10&lt;/div&gt;&lt;/div&gt;
                &lt;/td&gt;
                        &lt;td class=&quot;crayon-code&quot;&gt;&lt;div class=&quot;crayon-pre&quot; style=&quot;font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;&quot;&gt;&lt;div class=&quot;crayon-line&quot; id=&quot;crayon-580270f9a8c25730712728-1&quot;&gt;&lt;span class=&quot;crayon-p&quot;&gt;# 当前最新的Docker是1.6.2，Compose为1.2.0&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;crayon-line crayon-striped-line&quot; id=&quot;crayon-580270f9a8c25730712728-2&quot;&gt;&lt;span class=&quot;crayon-v&quot;&gt;curl&lt;/span&gt;&lt;span class=&quot;crayon-h&quot;&gt; &lt;/span&gt;&lt;span class=&quot;crayon-o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;crayon-i&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;crayon-h&quot;&gt; &lt;/span&gt;&lt;span class=&quot;crayon-v&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;crayon-o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;crayon-c&quot;&gt;//get.docker.io/ubuntu/ | sudo sh&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;crayon-line&quot; id=&quot;crayon-580270f9a8c25730712728-3&quot;&gt;&lt;span class=&quot;crayon-e&quot;&gt;sudo &lt;/span&gt;&lt;span class=&quot;crayon-v&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;crayon-o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;crayon-e&quot;&gt;get &lt;/span&gt;&lt;span class=&quot;crayon-e&quot;&gt;update&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;crayon-line crayon-striped-line&quot; id=&quot;crayon-580270f9a8c25730712728-4&quot;&gt;&lt;span class=&quot;crayon-e&quot;&gt;sudo &lt;/span&gt;&lt;span class=&quot;crayon-v&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;crayon-o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;crayon-e&quot;&gt;get &lt;/span&gt;&lt;span class=&quot;crayon-e&quot;&gt;install &lt;/span&gt;&lt;span class=&quot;crayon-v&quot;&gt;lxc&lt;/span&gt;&lt;span class=&quot;crayon-o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;crayon-v&quot;&gt;docker&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;crayon-line&quot; id=&quot;crayon-580270f9a8c25730712728-5&quot;&gt;&lt;span class=&quot;crayon-p&quot;&gt;# 参考http://docs.docker.com/compose/install/#install-compose&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;crayon-line crayon-striped-line&quot; id=&quot;crayon-580270f9a8c25730712728-6&quot;&gt;&lt;span class=&quot;crayon-v&quot;&gt;curl&lt;/span&gt;&lt;span class=&quot;crayon-h&quot;&gt; &lt;/span&gt;&lt;span class=&quot;crayon-o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;crayon-i&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;crayon-h&quot;&gt; &lt;/span&gt;&lt;span class=&quot;crayon-v&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;crayon-o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;crayon-c&quot;&gt;//github.com/docker/compose/releases/download/1.2.0/docker-compose-</code>uname -s<code>-</code>uname -m` &gt; /usr/local/bin/docker-compose</textarea></div><div class="crayon-line" id="crayon-580270f9a8c25730712728-7"><span class="crayon-v">chmod</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">docker</span><span class="crayon-o">-</span><span class="crayon-v">compose</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c25730712728-8"><span class="crayon-p">### 上面这个方法真的慢出翔，可以通过Python pip安装。</span></div><div class="crayon-line" id="crayon-580270f9a8c25730712728-9"><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-e">pip </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-e">dev</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c25730712728-10"><span class="crayon-e">pip </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">U</span><span class="crayon-h"> </span><span class="crayon-v">docker</span><span class="crayon-o">-</span><span class="crayon-v">compose</span></div></div><br>                    <br>                <br>            </div><br>        <br><!-- [Format Time: 0.0020 seconds] --><br><p></p><br><p>这样compose就安装好了，查看一下compose的版本信息：</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c44835397497" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">chmod +x /usr/local/bin/docker-compose<br>docker-compose -version<br>docker-compose 1.2.0</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c44835397497-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c44835397497-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c44835397497-3">3</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c44835397497-1"><span class="crayon-r">chmod</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">docker</span><span class="crayon-o">-</span><span class="crayon-e">compose</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c44835397497-2"><span class="crayon-v">docker</span><span class="crayon-o">-</span><span class="crayon-v">compose</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">version</span></div><div class="crayon-line" id="crayon-580270f9a8c44835397497-3"><span class="crayon-v">docker</span><span class="crayon-o">-</span><span class="crayon-i">compose</span><span class="crayon-h"> </span><span class="crayon-cn">1.2.0</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0011 seconds] --><br><p></p><br><h2>2. 使用Compose</h2><br><p>使用Compose只需要简单的三个步骤：<br><br>首先，使用Dockerfile来定义你的应用环境：</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c48878639680" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">FROM python:2.7<br>ADD ./code<br>WORKDIR /code<br>RUN pip install -r requirements.txt</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c48878639680-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c48878639680-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c48878639680-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c48878639680-4">4</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c48878639680-1"><span class="crayon-e">FROM </span><span class="crayon-v">python</span><span class="crayon-o">:</span><span class="crayon-cn">2.7</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c48878639680-2"><span class="crayon-i">ADD</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-e">code</span></div><div class="crayon-line" id="crayon-580270f9a8c48878639680-3"><span class="crayon-v">WORKDIR</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">code</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c48878639680-4"><span class="crayon-e">RUN </span><span class="crayon-e">pip </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">r</span><span class="crayon-h"> </span><span class="crayon-v">requirements</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0008 seconds] --><br><p></p><br><p>其中，requirements.txt中的内容包括：</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c4d809478886" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">flask<br>redis</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c4d809478886-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c4d809478886-2">2</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c4d809478886-1"><span class="crayon-e">flask</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c4d809478886-2"><span class="crayon-v">redis</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0003 seconds] --><br><p></p><br><p>再用Python写一个简单的app.py</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c51291884198" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from flask importFlaskfrom redis importRedisimport os<br>app =Flask(<strong>name</strong>)<br>redis =Redis(host=’redis’, port=6379)@app.route(‘/‘)def hello():<br>    redis.incr(‘hits’)return’Hello World! I have been seen %s times.’% redis.get(‘hits’)if <strong>name</strong> ==”<strong>main</strong>“:<br>    app.run(host=”0.0.0.0”, debug=True)</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c51291884198-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c51291884198-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c51291884198-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c51291884198-4">4</div><div class="crayon-num" data-line="crayon-580270f9a8c51291884198-5">5</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c51291884198-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">flask </span><span class="crayon-e">importFlaskfrom </span><span class="crayon-e">redis </span><span class="crayon-e">importRedisimport </span><span class="crayon-k ">os</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c51291884198-2"><span class="crayon-v">app</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-e">Flask</span><span class="crayon-sy">(</span><span class="crayon-v"><strong>name</strong></span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-580270f9a8c51291884198-3"><span class="crayon-v">redis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-e">Redis</span><span class="crayon-sy">(</span><span class="crayon-v">host</span><span class="crayon-o">=</span><span class="crayon-s">‘redis’</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-o">=</span><span class="crayon-cn">6379</span><span class="crayon-sy">)</span><span class="crayon-sy">@</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">route</span><span class="crayon-sy">(</span><span class="crayon-s">‘/‘</span><span class="crayon-sy">)</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">hello</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c51291884198-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">redis</span><span class="crayon-sy">.</span><span class="crayon-e">incr</span><span class="crayon-sy">(</span><span class="crayon-s">‘hits’</span><span class="crayon-sy">)</span><span class="crayon-st">return</span><span class="crayon-s">‘Hello World! I have been seen %s times.’</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">redis</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">‘hits’</span><span class="crayon-sy">)</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v"><strong>name</strong></span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-s">“<strong>main</strong>“</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-580270f9a8c51291884198-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-v">host</span><span class="crayon-o">=</span><span class="crayon-s">“0.0.0.0”</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">debug</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0027 seconds] --><br><p></p><br><p><strong>第二步</strong>，用一个compose.yaml来定义你的应用服务，他们可以把不同的服务生成不同的容器中组成你的应用。</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c55508636029" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">web:<br>  build:.<br>  command: python app.py<br>  ports:<br>         - “5000:5000”<br>  volumes:<br>         - .:/code<br>  links:<br>         - redis<br>redis:<br>  image: redis</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c55508636029-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c55508636029-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c55508636029-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c55508636029-4">4</div><div class="crayon-num" data-line="crayon-580270f9a8c55508636029-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c55508636029-6">6</div><div class="crayon-num" data-line="crayon-580270f9a8c55508636029-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c55508636029-8">8</div><div class="crayon-num" data-line="crayon-580270f9a8c55508636029-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c55508636029-10">10</div><div class="crayon-num" data-line="crayon-580270f9a8c55508636029-11">11</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c55508636029-1"><span class="crayon-s ">web</span><span class="">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c55508636029-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">build</span><span class="">:.</span></div><div class="crayon-line" id="crayon-580270f9a8c55508636029-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">command</span><span class="">: python app.py</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c55508636029-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">ports</span><span class="">:</span></div><div class="crayon-line" id="crayon-580270f9a8c55508636029-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-<span class="crayon-h"> </span><span class="crayon-i ">“5000:5000”</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c55508636029-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">volumes</span><span class="">:</span></div><div class="crayon-line" id="crayon-580270f9a8c55508636029-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-<span class="crayon-h"> </span><span class="crayon-o">.</span><span class="">:/code</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c55508636029-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">links</span><span class="">:</span></div><div class="crayon-line" id="crayon-580270f9a8c55508636029-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-<span class="crayon-h"> </span>redis</div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c55508636029-10"><span class="crayon-s ">redis</span><span class="">:</span></div><div class="crayon-line" id="crayon-580270f9a8c55508636029-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">image</span><span class="">: redis</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0007 seconds] --><br><p></p><br><p><strong>第三步</strong>，执行<code>docker-compose up</code>来启动你的应用，它会根据compose.yaml的设置来pull/run这俩个容器，然后再启动。</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c5a806091571" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Creating myapp_redis_1…<br>Creating myapp_web_1…<br>Building web…<br>Step 0 : FROM python:2.7<br>2.7: Pulling from python<br>…<br>Status: Downloaded newer image for python:2.7<br> —&gt; d833e0b23482<br>Step 1 : ADD . /code<br> —&gt; 1c04b1b15808<br>Removing intermediate container 9dab91b4410d<br>Step 2 : WORKDIR /code<br> —&gt; Running in f495a62feac9<br> —&gt; ffea89a7b090<br>Attaching to myapp_redis_1, myapp_web_1<br>……<br>redis_1 | [1] 17 May 10:42:38.147 <em> The server is now ready to accept connections on port 6379<br>web_1   |  </em> Running on <a href="http://0.0.0.0:5000/" target="_blank" rel="external">http://0.0.0.0:5000/</a> (Press CTRL+C to quit)<br>web_1   |  <em> Restarting with stat</em></textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-4">4</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-6">6</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-8">8</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-10">10</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-12">12</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-14">14</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-16">16</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c5a806091571-18">18</div><div class="crayon-num" data-line="crayon-580270f9a8c5a806091571-19">19</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c5a806091571-1"><span class="crayon-e">Creating </span><span class="crayon-v">myapp_redis_1</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-2"><span class="crayon-e">Creating </span><span class="crayon-v">myapp_web_1</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-3"><span class="crayon-e">Building </span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-4"><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">FROM </span><span class="crayon-v">python</span><span class="crayon-o">:</span><span class="crayon-cn">2.7</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-5"><span class="crayon-cn">2.7</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Pulling </span><span class="crayon-e">from </span><span class="crayon-i">python</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-6"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-7"><span class="crayon-v">Status</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Downloaded </span><span class="crayon-e">newer </span><span class="crayon-e">image </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">python</span><span class="crayon-o">:</span><span class="crayon-cn">2.7</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-8"><span class="crayon-h"> </span><span class="crayon-o">–</span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-e">d833e0b23482</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-9"><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">ADD</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">code</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-10"><span class="crayon-h"> </span><span class="crayon-o">–</span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1c04b1b15808</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-11"><span class="crayon-e">Removing </span><span class="crayon-e">intermediate </span><span class="crayon-i">container</span><span class="crayon-h"> </span><span class="crayon-cn">9dab91b4410d</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-12"><span class="crayon-i">Step</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">WORKDIR</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">code</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-13"><span class="crayon-h"> </span><span class="crayon-o">–</span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-e">Running </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">f495a62feac9</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-14"><span class="crayon-h"> </span><span class="crayon-o">–</span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-e">ffea89a7b090</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-15"><span class="crayon-e">Attaching </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-v">myapp_redis_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">myapp<em>web</em></span><span class="crayon-sy"></span>1</div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-16"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-17"><span class="crayon-v">redis_1</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-h"> </span><span class="crayon-i">May</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">42</span><span class="crayon-o">:</span><span class="crayon-cn">38.147</span><span class="crayon-h"> </span><span class="crayon-o"></span><span class="crayon-h"> </span><span class="crayon-e">The </span><span class="crayon-e">server </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">now </span><span class="crayon-e">ready </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">accept </span><span class="crayon-e">connections </span><span class="crayon-e">on </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">6379</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c5a806091571-18"><span class="crayon-v">web_1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o"><em></em></span><span class="crayon-h"> </span><span class="crayon-e">Running </span><span class="crayon-e">on </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//0.0.0.0:5000/ (Press CTRL+C to quit)</span></div><div class="crayon-line" id="crayon-580270f9a8c5a806091571-19"><span class="crayon-v">web_1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o"></span><span class="crayon-h"> </span><span class="crayon-e">Restarting </span><span class="crayon-e">with </span><span class="crayon-v">stat</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0039 seconds] --><br><p></p><br><h2>3. Yaml文件参考</h2><br><p>在上面的yaml文件中，我们可以看到compose文件的基本结构。首先是定义一个服务名，下面是yaml服务中的一些选项条目：<br><br><code>image</code>:镜像的ID<br><br><code>build</code>:直接从pwd的Dockerfile来build，而非通过image选项来pull<br><br><code>links</code>：连接到那些容器。每个占一行，格式为SERVICE[:ALIAS],例如 – db[:database]<br><br><code>external_links</code>：连接到该compose.yaml文件之外的容器中，比如是提供共享或者通用服务的容器服务。格式同links<br><br><code>command</code>：替换默认的command命令<br><br><code>ports</code>: 导出端口。格式可以是：</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c61341321587" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">ports:-“3000”-“8000:8000”-“127.0.0.1:8001:8001”</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c61341321587-1">1</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c61341321587-1"><span class="crayon-v">ports</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-s">“3000”</span><span class="crayon-o">-</span><span class="crayon-s">“8000:8000”</span><span class="crayon-o">-</span><span class="crayon-s">“127.0.0.1:8001:8001”</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0005 seconds] --><br><p></p><br><p><code>expose</code>：导出端口，但不映射到宿主机的端口上。它仅对links的容器开放。格式直接指定端口号即可。<br><br><code>volumes</code>：加载路径作为卷，可以指定只读模式：</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c65962076142" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">volumes:-/var/lib/mysql<br> - cache/:/tmp/cache<br> -~/configs:/etc/configs/:ro</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c65962076142-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c65962076142-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c65962076142-3">3</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c65962076142-1"><span class="crayon-v">volumes</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">lib</span><span class="crayon-o">/</span><span class="crayon-v">mysql</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c65962076142-2"><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-o">/</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-v">cache</span></div><div class="crayon-line" id="crayon-580270f9a8c65962076142-3"><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-v">configs</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">configs</span><span class="crayon-o">/</span><span class="crayon-o">:</span><span class="crayon-v">ro</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0009 seconds] --><br><p></p><br><p><code>volumes_from</code>：加载其他容器或者服务的所有卷</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c69471704775" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">environment:- RACK_ENV=development<br>  - SESSION_SECRET</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c69471704775-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c69471704775-2">2</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c69471704775-1"><span class="crayon-v">environment</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">RACK_ENV</span><span class="crayon-o">=</span><span class="crayon-v">development</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c69471704775-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">SESSION_SECRET</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0005 seconds] --><br><p></p><br><p><code>env_file</code>：从一个文件中导入环境变量，文件的格式为RACK_ENV=development<br><br><code>extends</code>:扩展另一个服务，可以覆盖其中的一些选项。一个sample如下：</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c6e528736605" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">common.yml<br>webapp:<br>  build:./webapp<br>  environment:- DEBUG=false- SEND_EMAILS=false<br>development.yml<br>web:extends:<br>    file: common.yml<br>    service: webapp<br>  ports:-“8000:8000”<br>  links:- db<br>  environment:- DEBUG=true<br>db:<br>  image: postgres</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c6e528736605-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c6e528736605-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c6e528736605-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c6e528736605-4">4</div><div class="crayon-num" data-line="crayon-580270f9a8c6e528736605-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c6e528736605-6">6</div><div class="crayon-num" data-line="crayon-580270f9a8c6e528736605-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c6e528736605-8">8</div><div class="crayon-num" data-line="crayon-580270f9a8c6e528736605-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c6e528736605-10">10</div><div class="crayon-num" data-line="crayon-580270f9a8c6e528736605-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c6e528736605-12">12</div><div class="crayon-num" data-line="crayon-580270f9a8c6e528736605-13">13</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c6e528736605-1">common<span class="crayon-o">.</span>yml</div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c6e528736605-2"><span class="crayon-s ">webapp</span><span class="">:</span></div><div class="crayon-line" id="crayon-580270f9a8c6e528736605-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">build</span><span class="">:./webapp</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c6e528736605-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">environment</span><span class="">:- DEBUG=false- SEND_EMAILS=false</span></div><div class="crayon-line" id="crayon-580270f9a8c6e528736605-5">development<span class="crayon-o">.</span>yml</div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c6e528736605-6"><span class="crayon-s ">web</span><span class="">:extends</span><span class="">:</span></div><div class="crayon-line" id="crayon-580270f9a8c6e528736605-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s ">file</span><span class="">: common.yml</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c6e528736605-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s ">service</span><span class="">: webapp</span></div><div class="crayon-line" id="crayon-580270f9a8c6e528736605-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">ports</span><span class="">:-“8000</span><span class="">:8000”</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c6e528736605-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">links</span><span class="">:- db</span></div><div class="crayon-line" id="crayon-580270f9a8c6e528736605-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">environment</span><span class="">:- DEBUG=true</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c6e528736605-12"><span class="crayon-s ">db</span><span class="">:</span></div><div class="crayon-line" id="crayon-580270f9a8c6e528736605-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s ">image</span><span class="">: postgres</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0008 seconds] --><br><p></p><br><p><code>net</code>：容器的网络模式，可以为”bridge”, “none”, “container:[name or id]”, “host”中的一个。<br><br><code>dns</code>：可以设置一个或多个自定义的DNS地址。<br><br><code>dns_search</code>:可以设置一个或多个DNS的扫描域。<br><br>其他的<code>working_dir, entrypoint, user, hostname, domainname, mem_limit, privileged, restart, stdin_open, tty, cpu_shares</code>，和<code>docker run</code>命令是一样的，这些命令都是单行的命令。例如：</p><br><p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta --><br><br>        <div id="crayon-580270f9a8c72058180962" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;"><br><br>            <div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">cpu_shares:73<br>working_dir:/code<br>entrypoint: /code/entrypoint.sh<br>user: postgresql<br>hostname: foo<br>domainname: foo.com<br>mem_limit:1000000000<br>privileged:true<br>restart: always<br>stdin_open:true<br>tty:true</textarea></div><br>            <div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><br>                <table class="crayon-table"><br>                    <tbody><tr class="crayon-row"><br>                <td class="crayon-nums " data-settings="show"><br>                    <div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-580270f9a8c72058180962-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c72058180962-2">2</div><div class="crayon-num" data-line="crayon-580270f9a8c72058180962-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c72058180962-4">4</div><div class="crayon-num" data-line="crayon-580270f9a8c72058180962-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c72058180962-6">6</div><div class="crayon-num" data-line="crayon-580270f9a8c72058180962-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c72058180962-8">8</div><div class="crayon-num" data-line="crayon-580270f9a8c72058180962-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-580270f9a8c72058180962-10">10</div><div class="crayon-num" data-line="crayon-580270f9a8c72058180962-11">11</div></div><br>                </td><br>                        <td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-580270f9a8c72058180962-1"><span class="crayon-v">cpu_shares</span><span class="crayon-o">:</span><span class="crayon-cn">73</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c72058180962-2"><span class="crayon-v">working_dir</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-e">code</span></div><div class="crayon-line" id="crayon-580270f9a8c72058180962-3"><span class="crayon-v">entrypoint</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">code</span><span class="crayon-o">/</span><span class="crayon-v">entrypoint</span><span class="crayon-sy">.</span><span class="crayon-e">sh</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c72058180962-4"><span class="crayon-v">user</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">postgresql</span></div><div class="crayon-line" id="crayon-580270f9a8c72058180962-5"><span class="crayon-v">hostname</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">foo</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c72058180962-6"><span class="crayon-v">domainname</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">foo</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-580270f9a8c72058180962-7"><span class="crayon-v">mem_limit</span><span class="crayon-o">:</span><span class="crayon-cn">1000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c72058180962-8"><span class="crayon-v">privileged</span><span class="crayon-o">:</span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-580270f9a8c72058180962-9"><span class="crayon-v">restart</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">always</span></div><div class="crayon-line crayon-striped-line" id="crayon-580270f9a8c72058180962-10"><span class="crayon-v">stdin_open</span><span class="crayon-o">:</span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-580270f9a8c72058180962-11"><span class="crayon-v">tty</span><span class="crayon-o">:</span><span class="crayon-t">true</span></div></div></td><br>                    </tr><br>                </tbody></table><br>            </div><br>        </div><br><!-- [Format Time: 0.0013 seconds] --><br><p></p><br><h2>4. docker-compose常用命令</h2><br><p>在第二节中的<code>docker-compose up</code>，这两个容器都是在前台运行的。我们可以指定-d命令以daemon的方式启动容器。除此之外，docker-compose还支持下面参数：<br><br><code>–verbose</code>：输出详细信息<br><br><code>-f</code> 制定一个非docker-compose.yml命名的yaml文件<br><br><code>-p</code> 设置一个项目名称（默认是directory名）<br><br>docker-compose的动作包括：<br><br><code>build</code>：构建服务<br><br><code>kill -s SIGINT</code>：给服务发送特定的信号。<br><br><code>logs</code>：输出日志<br><br><code>port</code>：输出绑定的端口<br><br><code>ps</code>：输出运行的容器<br><br><code>pull</code>：pull服务的image<br><br><code>rm</code>：删除停止的容器<br><br><code>run</code>: 运行某个服务，例如docker-compose run web python manage.py shell<br><br><code>start</code>：运行某个服务中存在的容器。<br><br><code>stop</code>:停止某个服务中存在的容器。<br><br><code>up</code>：create + run + attach容器到服务。<br><br><code>scale</code>：设置服务运行的容器数量。例如：docker-compose scale web=2 worker=3<br><br>参考:<br><br><a href="http://docs.docker.com/compose/" target="_blank" rel="external">Compose Document</a></p><br>                        <div class="clear"></div><br>                                            

<blockquote>
<p>转载:<a href="http://debugo.com/docker-compose" target="_blank" rel="external">http://debugo.com/docker-compose</a></p>
</blockquote>


            
            
            <blockquote>
                <p>
                本文地址：
                <a href="http://blog.yfgeek.com/2016/10/15/Docker-Compose—简化复杂应用的利器/" target="_blank" rel="external">http://blog.yfgeek.com/2016/10/15/Docker-Compose—简化复杂应用的利器/</a>
                </p>
                <footer><cite><a href="http://blog.yfgeek.com">@Ivan's Blog</a></cite></footer>
            </blockquote>
            </div>
            
<nav class="post-nav">
  

  
    <div class="waves-block waves-effect next fr">
      <a href="/2016/10/12/程序员鄙视链/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">程序员鄙视链</h4>
      </a>
    </div>
  
</nav>


            
            
<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="Docker-Compose—简化复杂应用的利器" data-title="Docker Compose—简化复杂应用的利器 " data-url="http://blog.yfgeek.com/2016/10/15/Docker-Compose—简化复杂应用的利器/index.html"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"yifani"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>





        </div>
    </div>
</article>
    </div>
  </main>
<div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script src="/js/main.js"></script>



<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<script type="text/template" id="search-tpl">
<li class="item">
    <a href="/{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</script>

<script src="/js/search.js"></script>









</body>
</html>
